â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                 ğŸ”´ PROBLÃˆME VARIABLES INTERDITES - SOLUTION                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ RÃ‰SUMÃ‰ DU PROBLÃˆME
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âŒ Ces variables causent l'Ã©chec du dÃ©ploiement:
   â€¢ AzureWebJobsStorage
   â€¢ FUNCTIONS_WORKER_RUNTIME
   â€¢ AzureWebJobsStorageConnectionString
   â€¢ WEBSITE_NODE_DEFAULT_VERSION

ğŸ’¡ Raison: Azure Static Web Apps gÃ¨re automatiquement les Functions.
   Ces variables sont pour Azure Functions STANDALONE seulement !

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                          âœ… SOLUTION EN 3 Ã‰TAPES                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€ Ã‰TAPE 1: CRÃ‰ER NOUVELLE APPLICATION PROPRE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚  Option A - Script Automatique (RECOMMANDÃ‰) ğŸš€                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚
â”‚  export GITHUB_TOKEN=ghp_votre_token_github_ici                           â”‚
â”‚  ./scripts/create-new-static-app.sh Axilum2030-v2                         â”‚
â”‚                                                                             â”‚
â”‚  Option B - Commande Manuelle                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                 â”‚
â”‚  az staticwebapp create \                                                  â”‚
â”‚    --name Axilum2030-v2 \                                                  â”‚
â”‚    --resource-group Axilum2030_group \                                     â”‚
â”‚    --location westus2 \                                                    â”‚
â”‚    --source https://github.com/axilum2025/Axilum2030 \                    â”‚
â”‚    --branch main \                                                         â”‚
â”‚    --app-location "public" \                                               â”‚
â”‚    --api-location "api" \                                                  â”‚
â”‚    --output-location "" \                                                  â”‚
â”‚    --token ghp_votre_token_github_ici \                                   â”‚
â”‚    --sku Free                                                              â”‚
â”‚                                                                             â”‚
â”‚  Option C - Portail Azure                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚
â”‚  https://portal.azure.com â†’ CrÃ©er â†’ Static Web App                        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Ã‰TAPE 2: CONFIGURER LE SECRET GITHUB â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚  1. RÃ©cupÃ©rer le token de dÃ©ploiement:                                     â”‚
â”‚     az staticwebapp secrets list \                                         â”‚
â”‚       --name Axilum2030-v2 \                                               â”‚
â”‚       --resource-group Axilum2030_group \                                  â”‚
â”‚       --query "properties.apiKey" -o tsv                                   â”‚
â”‚                                                                             â”‚
â”‚  2. Ajouter dans GitHub:                                                   â”‚
â”‚     https://github.com/axilum2025/Axilum2030/settings/secrets/actions     â”‚
â”‚     Nom: AZURE_STATIC_WEB_APPS_API_TOKEN_AXILUM2030_V2                    â”‚
â”‚     Valeur: (le token de l'Ã©tape 1)                                        â”‚
â”‚                                                                             â”‚
â”‚  3. Mettre Ã  jour le workflow:                                             â”‚
â”‚     Fichier: .github/workflows/azure-static-web-apps-*.yml                â”‚
â”‚     Ligne Ã  modifier:                                                      â”‚
â”‚     azure_static_web_apps_api_token: ${{ secrets.AZURE_STATIC_WEB_APPS_API_TOKEN_AXILUM2030_V2 }}
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Ã‰TAPE 3: CONFIGURER LES VARIABLES (AUTORISÃ‰ES SEULEMENT) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚  1. CrÃ©er .env.azure avec vos clÃ©s API:                                    â”‚
â”‚                                                                             â”‚
â”‚     âœ… AUTORISÃ‰ES:                                                         â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚     GROQ_API_KEY=...                                                       â”‚
â”‚     AZURE_STORAGE_CONNECTION_STRING=...                                    â”‚
â”‚     AZURE_COMMUNICATION_CONNECTION_STRING=...                              â”‚
â”‚     AZURE_COMMUNICATION_SENDER=...                                         â”‚
â”‚     BRAVE_API_KEY=...                                                      â”‚
â”‚     AZURE_VISION_ENDPOINT=...                                              â”‚
â”‚     AZURE_VISION_KEY=...                                                   â”‚
â”‚     GEMINI_API_KEY=...                                                     â”‚
â”‚     GOOGLE_FACT_CHECK_API_KEY=...                                          â”‚
â”‚     SENDGRID_API_KEY=...                                                   â”‚
â”‚     SENDGRID_SENDER=...                                                    â”‚
â”‚                                                                             â”‚
â”‚     âŒ INTERDITES (NE PAS AJOUTER):                                        â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚
â”‚     AzureWebJobsStorage                                                    â”‚
â”‚     FUNCTIONS_WORKER_RUNTIME                                               â”‚
â”‚     AzureWebJobsStorageConnectionString                                    â”‚
â”‚     WEBSITE_NODE_DEFAULT_VERSION                                           â”‚
â”‚                                                                             â”‚
â”‚  2. ExÃ©cuter le script de configuration:                                   â”‚
â”‚     ./configure-azure-env.sh                                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                           ğŸ“š FICHIERS UTILES                                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“– FIX_FORBIDDEN_VARIABLES.md      â†’ Guide complet Ã©tape par Ã©tape
ğŸ§¹ scripts/clean-forbidden-settings.sh â†’ Nettoyer variables interdites
ğŸš€ scripts/create-new-static-app.sh    â†’ CrÃ©er nouvelle app proprement
âš™ï¸  configure-azure-env.sh              â†’ Configurer variables autorisÃ©es
ğŸ“‹ ENVIRONMENT_VARIABLES.md        â†’ Liste complÃ¨te des variables

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                            ğŸ” VÃ‰RIFICATION                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… VÃ©rifier qu'aucune variable interdite n'est configurÃ©e:
   az staticwebapp appsettings list \
     --name Axilum2030-v2 \
     --resource-group Axilum2030_group \
     --query "properties" -o json | jq 'keys'

âœ… VÃ©rifier le dÃ©ploiement sur GitHub Actions:
   https://github.com/axilum2025/Axilum2030/actions

âœ… Tester l'application:
   curl https://votre-app.azurestaticapps.net/api/diagnosticEmail

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                          ğŸ†˜ EN CAS DE PROBLÃˆME                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Si l'erreur persiste:

1. Nettoyer les variables interdites:
   ./scripts/clean-forbidden-settings.sh Axilum2030-v2

2. VÃ©rifier le workflow GitHub:
   cat .github/workflows/azure-static-web-apps-*.yml

3. Consulter la documentation complÃ¨te:
   cat FIX_FORBIDDEN_VARIABLES.md

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’¡ RAPPEL: Azure Static Web Apps gÃ¨re AUTOMATIQUEMENT les Functions.
   Ne configurez JAMAIS les variables AzureWebJobs* ou FUNCTIONS_*

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
